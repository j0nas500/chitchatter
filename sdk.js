!function(){function t(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function e(t,e,n,r,o,i,u){try{var a=t[i](u),c=a.value}catch(t){n(t);return}a.done?e(c):Promise.resolve(c).then(r,o)}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function u(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function c(t,e,n){return(c=a()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&o(i,n.prototype),i}).apply(null,arguments)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t){var e="function"==typeof Map?new Map:void 0;return(s=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return c(t,arguments,l(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),o(n,t)})(t)}"function"==typeof SuppressedError&&SuppressedError,(f=y||(y={})).GET_SDK_CONFIG="getSdkConfig",f.IS_EMBEDDED="embed",f.PARENT_DOMAIN="parentDomain",(p=b||(b={})).CONFIG="config",p.CONFIG_REQUESTED="configRequested",(d=g||(g={})).COLOR_MODE="color-mode",d.PLAY_MESSAGE_SOUND="play-message-sound",d.ROOM_NAME="room",d.ROOT_URL="root-url",d.USER_ID="user-id",d.USER_NAME="user-name";var f,p,d,h,y,b,g,m,v=function(t){var e=t.data;return"object"==typeof e&&null!==e&&"name"in e&&"string"==typeof e.name&&"payload"in e&&"object"==typeof e.payload};(h=m||(m={})).DARK="dark",h.LIGHT="light";var E=Object.values(m).map(String),R=["camera","microphone","display-capture","fullscreen"],O=["height","referrerpolicy","sandbox","style","width"],w=/*#__PURE__*/function(i){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(d,i);var c,s,f,p=(c=a(),function(){var e,n,r=l(d);if(c){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(e=n)&&("object"==(e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e)||"function"==typeof e)?e:t(this)});function d(){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,d),e=p.apply(this,arguments),e.configRequestExpirationTimout=null,e.iframe=document.createElement("iframe"),e.sendConfigToChat=function(){var n,r=t(e),o=r.iframe,i=r.rootUrl,u=new URL(i).origin,a={name:b.CONFIG,payload:e.chatConfig};null===(n=o.contentWindow)||void 0===n||n.postMessage(a,u)},e.handleConfigRequestedMessage=function(n){var r=t(e).rootUrl;new URL(r).origin===n.origin&&v(n)&&n.data.name===b.CONFIG_REQUESTED&&(e.sendConfigToChat(),e.stopListeningForConfigRequest())},e.stopListeningForConfigRequest=function(){window.removeEventListener("message",e.handleConfigRequestedMessage),null!==e.configRequestExpirationTimout&&(clearInterval(e.configRequestExpirationTimout),e.configRequestExpirationTimout=null)},e}return s=[{key:"chatConfig",get:function(){var t,e,n={};this.hasAttribute(g.USER_ID)&&(n.userId=null!==(t=this.getAttribute(g.USER_ID))&&void 0!==t?t:""),this.hasAttribute(g.USER_NAME)&&(n.customUsername=this.getAttribute(g.USER_NAME)),n.playSoundOnNewMessage=!!this.hasAttribute(g.PLAY_MESSAGE_SOUND);var r=null!==(e=this.getAttribute(g.COLOR_MODE))&&void 0!==e?e:"";return E.includes(r)&&(n.colorMode=r),n}},{key:"rootUrl",get:function(){var t;return null!==(t=this.getAttribute(g.ROOT_URL))&&void 0!==t?t:"https://chitchatter.im/"}},{key:"listenForConfigRequest",value:function(){var t,n=this;return(t=function(){return function(t,e){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(u=0)),u;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,r=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){u=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){u.label=a[1];break}if(6===a[0]&&u.label<o[1]){u.label=o[1],o=a;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(a);break}o[2]&&u.ops.pop(),u.trys.pop();continue}a=e.call(t,u)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,function(t){return(// NOTE: This cancels any pending config request listeners
n.stopListeningForConfigRequest(),window.addEventListener("message",n.handleConfigRequestedMessage),n.configRequestExpirationTimout=setTimeout(function(){console.error("[chitchatter-sdk] configuration was not sent successfully"),n.stopListeningForConfigRequest()},1e4),[2])})},function(){var n=this,r=arguments;return new Promise(function(o,i){var u=t.apply(n,r);function a(t){e(u,o,i,a,c,"next",t)}function c(t){e(u,o,i,a,c,"throw",t)}a(void 0)})})()}},{key:"updateIframeAttributes",value:function(){var t=this.iframe,e=encodeURIComponent(null!==(l=this.getAttribute(g.ROOM_NAME))&&void 0!==l?l:window.location.href),n=new URLSearchParams((r(s={},y.IS_EMBEDDED,""),r(s,y.GET_SDK_CONFIG,""),r(s,y.PARENT_DOMAIN,encodeURIComponent(window.location.origin)),s)),o=new URL(this.rootUrl);o.pathname="public/".concat(e),o.search=n.toString();var i=o.href;i!==t.getAttribute("src")&&t.setAttribute("src",i);var u=!0,a=!1,c=void 0;try{for(var l,s,f,p=O[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var d=f.value,h=this.getAttribute(d);null!==h&&t.setAttribute(d,h)}}catch(t){a=!0,c=t}finally{try{u||null==p.return||p.return()}finally{if(a)throw c}}}},{key:"connectedCallback",value:function(){var t=this,e=this.attachShadow({mode:"open"}),n=this.iframe;n.style.border="none",n.setAttribute("allow",R.join(";")),e.appendChild(n),n.addEventListener("load",function(){t.listenForConfigRequest()})}},{key:"disconnectedCallback",value:function(){this.stopListeningForConfigRequest()}},{key:"attributeChangedCallback",value:function(t){this.updateIframeAttributes(),Object.values(g).map(String)// NOTE: Needed to avoid type warnings.
.includes(t)&&this.sendConfigToChat()}}],f=[{key:"observedAttributes",get:function(){return u(Object.values(g)).concat(u(O))}}],s&&n(d.prototype,s),f&&n(d,f),d}(s(HTMLElement));window.customElements.define("chat-room",w)}();//# sourceMappingURL=sdk.js.map

//# sourceMappingURL=sdk.js.map
